# Redis

## 持久化机制

Redis是内存型数据库，一旦发生宕机那么内存中的数据就会丢失。因此如果缓存的数据是重要的，那么必须要将Redis的数据持久化到磁盘中。

Redis有两种持久化机制`RDB`和`AOF`

RDB以快照的形式将数据持久化到磁盘，AOF则会把数据库的写入操作持久化到磁盘

如果在持久化过程中发生了新的数据写入：

- RDB采用COW（copy-on-write），当新的写请求对数据修改时，父进程会把数据复制给子进程，子进程继续对旧数据进行持久化，父进程则会处理新的写入请求。
- AOF采用AOF_BUFFER，将新的写入指令写入到缓冲区中（如果是在AOF文件重写时发生了新的写入，则写指令也会写入到AOF_REWRITE_BUFFER中）